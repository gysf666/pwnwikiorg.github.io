漏洞簡介
--------

在sudo解析命令行參數的方式中發現了基於堆的緩衝區溢出。任何本地用戶（普通用戶和系統用戶，sudoer和非sudoers）都可以利用此漏洞，而無需進行身份驗證，攻擊者不需要知道用戶的密碼。成功利用此漏洞可以獲得root權限。

用戶可以使用如下方法進行自查：以非root用戶登錄系統，並使用命令`sudoedit -s / `

如果響應一個以`sudoedit:`開頭的報錯，那麼表明存在漏洞。 如果響應一個以`usage:`開頭的報錯，那麼表明補丁已經生效。

漏洞測試成功的Linux發行版
-------------------------

    Ubuntu 16.04.5 kernel 4.15.0-29-generic

    Ubuntu 18.04.1 kernel 4.15.0-20-generic

    Ubuntu 19.04 kernel 5.0.0-15-generic

    Ubuntu Mate 18.04.2 kernel 4.18.0-15-generic

    Linux Mint 19 kernel 4.15.0-20-generic

    Xubuntu 16.04.4 kernel 4.13.0-36-generic

    ElementaryOS 0.4.1 4.8.0-52-generic

    Backbox 6 kernel 4.18.0-21-generic

    Parrot OS 4.5.1 kernel 4.19.0-

    parrot1-13t-amd64 Kali kernel 4.19.0-

    kali5-amd64

    Redcore 1806 (LXQT) kernel 4.16.16-

    redcoreMX 18.3 kernel 4.19.37-2~mx17+1

    RHEL 8.0 kernel 4.18.0-80.el8.x86_64

    Debian 9.4.0 kernel 4.9.0-6-amd64

    Debian 10.0.0 kernel 4.19.0-5-amd64

    Devuan 2.0.0 kernel 4.9.0-6-amd64

    SparkyLinux 5.8 kernel 4.19.0-5-amd64

    Fedora Workstation 30 kernel 5.0.9-301.fc30.x86_64

    Manjaro 18.0.3 kernel 4.19.23-1-

    MANJAROMageia 6 kernel 4.9.35-desktop-1.mga6

    Antergos 18.7 kernel 4.17.6-1-ARCH

POC
---

<https://haxx.in/CVE-2021-3156_nss_poc_ubuntu.tar.gz>

    cd CVE-2021-3156

    make

    ./sudo-hax-me-a-sandwich

可發現成功獲得ROOT權限。